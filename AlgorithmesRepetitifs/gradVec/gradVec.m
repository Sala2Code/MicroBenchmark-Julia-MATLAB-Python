n = 1000;
t = 0;

x = [-0.61175641, -0.24937038,  0.48851815,  0.76201118,  1.51981682,  0.37756379,  0.51292982, -0.67124613, -1.39649634,  0.31563495, -0.63699565, -0.39675353, -1.10061918,  0.90085595, -1.09989127,  0.82797464, -0.07557171, -0.35224985, -0.67066229, -1.07296862, -0.30620401,  2.18557541,  0.86540763,  0.19829972, -0.38405435, -0.68372786,  0.05080775,  0.58281521,  1.25286816, -0.75439794, -0.34934272, -0.88762896,  0.18656139,  0.87616892,  0.83898341, -0.50446586, -0.34385368,  1.6924546 , -2.3015387 ,  0.93110208,  2.10025514,  1.46210794, -0.84520564, -0.87785842, -0.3224172 ,  0.88514116,  0.16003707,  1.13162939, -0.37528495,  0.50249434, -0.20889423,  0.12015895,  0.58662319,  0.3190391 , -0.69166075,  0.69803203,  1.19891788, -0.20075807,  0.53035547,  0.74204416,  0.41005165,  0.11900865, -0.7612069 ,  0.42349435,  0.30017032, -1.1425182 ,  0.18515642, -0.93576943, -0.62000084, -1.11731035, -1.44411381, -0.22232814,  1.62434536,  0.61720311, -0.6871727 ,  0.07734007, -0.0126646 , -0.63873041,  1.13376944,  1.74481176,  0.90159072, -2.06014071,  0.2344157 , -0.17242821,  0.12182127,  1.14472371, -0.12289023, -0.74715829,  0.28558733, -2.02220122,  0.23009474, -0.26788808, -0.52817175,  1.12948391,  0.19091548, -0.29809284,  1.65980218,  0.04359686,  0.04221375, -0.19183555];
y = [-52.4568854; -15.39439866; 31.09298076; 81.29922354;133.5013812; 31.88110117;37.20705164;-40.03179671; -106.17554223; 24.639066; -48.50046802;-20.18047019;-92.07348237; 54.55792402;-88.03269964; 67.24781801; -9.89302113;-41.93584528;-59.73487076;-70.52478452; -26.77450907;177.61698746; 67.46572572; 21.33659327;-24.77159853; -48.34153575;2.47827403; 45.80048542;108.55222544;-62.75382452; -27.06345223;-66.26151874; 16.88850749; 72.89287434; 92.45898132; -31.70698544;-42.05759494;158.71803893; -189.16666685; 71.82648428; 167.51735412;111.50394103;-69.32543107;-64.8108726; -33.79908714; 72.34371505; 26.9415416;85.89817092;-29.54171881; 37.39534229; -29.28741926; 12.02641447; 63.3414933;26.43950925;-47.65582687; 61.57186756; 96.14806434; -6.32112365; 21.45691711; 58.19302951; 42.33541142;3.75391925;-44.04667419; 36.96121561; 30.16415401; -83.90759068; 17.32833857;-73.56373515;-34.97208383;-83.44356418; -117.44672502;-23.8844141; 141.09227065; 51.3687163; -57.5068713; 18.48181592;-15.18861638;-48.1692154;95.78274149;145.70060609; 97.38413861; -174.06609658; 11.19686853;-18.44845625; 27.50826761; 95.49878769; -9.59820867;-56.39070754; 30.82136659; -181.59266703;4.52545955;-12.54687448;-38.97063311; 83.28349563; 16.48951451; -24.00962303;133.02472573; 12.06315399; 27.25915157;-20.89459341];
    

for i = 1:n
    tic;
    main(x, y, 0.01, 1000);
    t = t+toc;
end
fprintf("Temps moyen (s) : %.12f", t/n);

function theta = main(x, y, alpha, n)
    s = size(x);
    s = s(2);

    X = [ones(s, 1), x(:)];
    y = reshape(y, s, 1);

    am = alpha/s;
    
    theta = zeros(2,1);

    for i = 1:n
        temp = X * theta;
        grad = X' * (temp-y);
        theta = theta - am * grad;
        % theta = theta - am * X' * (X*theta - y);
    end
end

